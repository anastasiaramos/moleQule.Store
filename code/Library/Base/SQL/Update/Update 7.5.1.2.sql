/* UPDATE 7.5.1.2*/

SET SEARCH_PATH = "COMMON";

UPDATE "Variable" SET "VALUE" = '7.5.1.2' WHERE "NAME" = 'STORE_DB_VERSION';

SET SEARCH_PATH = "0001";

ALTER TABLE "Producto" ADD COLUMN "IS_KIT" boolean DEFAULT FALSE;

DROP TABLE  IF EXISTS "STKit" CASCADE;
CREATE TABLE "STKit" 
( 
	"OID" bigserial NOT NULL,
	"OID_KIT" bigint,
    "OID_PRODUCT" bigint,
    "AMOUNT" numeric(10,2) DEFAULT 0,
	CONSTRAINT "PK_STKit" PRIMARY KEY ("OID") 
) WITHOUT OIDS;

ALTER TABLE "STKit" OWNER TO moladmin;
GRANT ALL ON TABLE "STKit" TO GROUP "MOLEQULE_ADMINISTRATOR";
	
ALTER TABLE ONLY "STKit"
    ADD CONSTRAINT "FK_STKit_STParent" FOREIGN KEY ("OID_KIT") REFERENCES "Producto"("OID") ON UPDATE CASCADE ON DELETE CASCADE;
	
ALTER TABLE ONLY "STKit"
    ADD CONSTRAINT "FK_STKit_STProduct" FOREIGN KEY ("OID_PRODUCT") REFERENCES "Producto"("OID") ON UPDATE CASCADE ON DELETE RESTRICT;	